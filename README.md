# Deepfake Social Engineering Training

An end-to-end LAMP application for the **deepfaketraining.com** experience. The application can be ran locally, but media content is not included with the code (GitHub limits repo size) and API calls to Google will need to be setup independently (see below).

Generative AI tools were used to create this project, including:
* https://chatgpt.com/
* https://grok.com/
* https://claude.ai/

## Stack

- PHP 8.3
- MySQL 8 (InnoDB, utf8mb4)
- HTML/CSS

## Database setup

```bash
mysql -u root -p < /Users/nhunt/Desktop/deepfaketraining.com/database/schema.sql
```

Optionally create an admin user manually:

```sql
INSERT INTO users (username, password_hash, is_admin)
VALUES ('admin', PASSWORD('ChangeMe123!'), 1);
```

> Replace `PASSWORD()` with `bcrypt` generated by PHP if your MySQL version does not support it. You can run `php -r "echo password_hash('ChangeMe123!', PASSWORD_DEFAULT), PHP_EOL;"`.

Run the script again any time you update the source files; duplicates are avoided per scenario title.

## Configure credentials

The application reads MySQL settings from environment variables (`DB_HOST`, `DB_NAME`, etc.). For quick local development, edit the base `config.php` or, preferably, copy `config.local.example.php` to `config.local.php` and override only the settings that differ from the defaults. `config.local.php` is git-ignored so production secrets never leave the server.

### Beta access gate

All pages are protected by a beta key so unpublished builds stay private. Update `app.beta_key` inside `config.php` (default `BetaKeyChangeMe`) and share it only with trusted testers. Anyone visiting the site will be redirected to `/beta.php` until they enter the key; once verified, their session proceeds normally and a secure cookie keeps them authorized for 30 days (unless you change the key). Clear the session via the “Reset beta session” link on that page or by deleting the browser cookies.

## Install PHP dependencies

The project relies on Google Cloud Text-to-Speech through Composer. Install vendor libraries (per environment):

```bash
cd /Users/nhunt/Desktop/deepfaketraining.com
composer install
```

(`vendor/` remains git-ignored, so this step is required on every machine that runs the app.)

## Run locally

From the project root:

```bash
php -S localhost:8000 -t public
```

Visit `http://localhost:8000`. Register a learner account or log in as the admin you created to manage scenarios.

## Platform Features

- **Interactive gameplay** – Pick a scenario, stream the stored audio/video clips directly from MySQL, and log guesses/accuracy.
- **Progress tracking** – Dashboard aggregates part 1 accuracy plus part 2 video completion status.
- **Admin console** – Upload unlimited scenarios and label which media file is the deepfake.

## Google Cloud Text-to-Speech setup

1. Enable the **Cloud Text-to-Speech API** in your Google Cloud project.
2. Create a service account, grant it permission to call the API, and download its JSON key.
3. On every environment that needs TTS, install Composer dependencies and set:
4. Export service account key and store at /opt/keys/
5. Optionally customize the default voice in `config.php` (`app.tts_voice`) or override it via `config.local.php`.

If dependencies or credentials are missing, the voicemail generator will respond with an error rather than attempting synthesis.
